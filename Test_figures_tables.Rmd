---
title: ''
author: ''
date: ''
output:
  pdf_document:
    fig_caption: yes
    highlight: haddock
    includes:
      in_header: header.tex
    keep_tex: yes
    latex_engine: xelatex
    template: Default_template_modified.tex
    number_sections: yes
    toc: yes
    toc_depth: 4
  html_document:
    toc: yes
  word_document: default
documentclass: article
fontsize: 12pt
geometry: margin=1in
csl: CJFAS.csl
bibliography: BibFile.bib
---
```{r global_options, include=FALSE}
    # set global options for R code chunks: echo=FALSE (don't include source code); 
    # warning=FALSE (suppress R warnings); message=FALSE (suppress R messages)
    # eval = TRUE is default
    knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r}
    # Read in preamble R code - including required libraries and the SS file(s)
    source('./Rcode/Preamble.R')
    source("./Rcode/MultiHeader.R")
    # Read in data/manipulations for executive summary tables and figures
    # It may take time to edit this file and get it ready for your assessment
    # Make small changes in this file and then try to compile the document
    # Commit when you have a success!
   # source('./Rcode/Exec_summary_figs_tables.R')
```

USE THIS .Rmd TO TEST R CODE CHUNKS, FIGURES AND PLOTS BEFORE INSERTING INTO THE MAIN TEXT OR TO DEBUG

```{r, results="asis"}
#read in index summary data for 2 MRFSS dockside indices
Fleet10_11_Filter = read.xlsx('./txt_files/Fleet10and11_MRFSSDockside_IndexData.xlsx', 
                            sheetName='BothFilter', header = T)

Fleet10_AIC = read.xlsx('./txt_files/Fleet10and11_MRFSSDockside_IndexData.xlsx', sheetName='NorthAIC', header=T)
Fleet11_AIC = read.xlsx('./txt_files/Fleet10and11_MRFSSDockside_IndexData.xlsx', sheetName='SouthAIC', header=T)


colnames(Fleet10_11_Filter) = c('Filter','Trips','Positive Trips')
Fleet10_11_Filter[4,] = c(NA,NA,NA)
Fleet10_11_Filter[9,] = c(NA,NA,NA)

Fleet10_11_Filter.table = xtable(Fleet10_11_Filter,
                               caption = c("Data filtering steps for the MRFSS dockside intercept survey 
                                           index of abundance for north and south of Pt. Conception."),
                               label = 'tab:Fleet10_11_Filter', digits = 0,
                               format.args = list(big.mark = ",",))

align(Fleet10_11_Filter.table) = c('l','l','c','c')

print(Fleet10_11_Filter.table, 
              include.rownames=FALSE, 
              caption.placement="top")


Fleet10_AIC.table = xtable(Fleet10_AIC,
                            caption = c("Model selection for the MRFSS dockside intercept survey 
                                        north of Pt. Conception. Bold 
                                        values indicate the model selected."),
                            label='tab:Fleet10_AIC')

print(Fleet10_AIC.table, 
              include.rownames=FALSE, 
              caption.placement="top",
              sanitize.text.function = function(x){x})


Fleet11_AIC.table = xtable(Fleet11_AIC,
                            caption = c("Model selection for the MRFSS dockside intercept 
                                        survey south of Pt. Conception. Bold 
                                        values indicate the model selected."),
                            label='tab:Fleet11_AIC')

print(Fleet11_AIC.table, 
              include.rownames=FALSE, 
              caption.placement="top",
              sanitize.text.function = function(x){x})
     
```