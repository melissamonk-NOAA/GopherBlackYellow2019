---
title: ''
author: ''
date: ''
output:
  pdf_document:
    fig_caption: yes
    highlight: haddock
    includes:
      in_header: header.tex
    keep_tex: yes
    latex_engine: xelatex
    template: Default_template_modified.tex
    number_sections: yes
    toc: yes
    toc_depth: 4
  html_document:
    toc: yes
  word_document: default
documentclass: article
fontsize: 12pt
geometry: margin=1in
csl: CJFAS.csl
bibliography: BibFile.bib
---
```{r global_options, include=FALSE}
    # set global options for R code chunks: echo=FALSE (don't include source code); 
    # warning=FALSE (suppress R warnings); message=FALSE (suppress R messages)
    # eval = TRUE is default
    knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r}
    # Read in preamble R code - including required libraries and the SS file(s)
    source('./Rcode/Preamble.R')
    source("./Rcode/MultiHeader.R")
    # Read in data/manipulations for executive summary tables and figures
    # It may take time to edit this file and get it ready for your assessment
    # Make small changes in this file and then try to compile the document
    # Commit when you have a success!
   # source('./Rcode/Exec_summary_figs_tables.R')
```

USE THIS .Rmd TO TEST R CODE CHUNKS, FIGURES AND PLOTS BEFORE INSERTING INTO THE MAIN TEXT OR TO DEBUG

```{r, results="asis"}
#read in index summary data for 2 onboard observer indices
Fleet6_7_Filter = read.xlsx('./txt_files/Fleet6and7_OnboardObserver_IndexData.xlsx', 
                            sheetName='BothFilter', header = T)

Fleet6_AIC = read.xlsx('./txt_files/Fleet6and7_OnboardObserver_IndexData.xlsx', sheetName='NorthAIC', header=T)
Fleet7_AIC = read.xlsx('./txt_files/Fleet6and7_OnboardObserver_IndexData.xlsx', sheetName='SouthAIC', header=T)


colnames(Fleet6_7_Filter) = c('Filter','Drifts','Positive Drifts')
Fleet6_7_Filter$Drifts = formatC(Fleet6_7_Filter$Drifts, digits = 0, format='f')
Fleet6_7_Filter$`Positive Drifts` = formatC(Fleet6_7_Filter$`Positive Drifts`, digits = 0, format='f')
Fleet6_7_Filter[10,] = c(NA,NA,NA)
Fleet6_7_Filter[14,] = c(NA,NA,NA)
Fleet6_7_Filter.table = xtable(Fleet6_7_Filter,
                       caption = c("Data filtering steps for the CRFS CPFV onboard observer 
                                        index of abundance for north and south of Pt. Conception."),
                       label = 'tab:Fleet6_&_Filter')
align(Fleet6_7_Filter.table) = c('l','l','c','c')
print(Fleet6_7_Filter.table, 
              include.rownames=FALSE, 
              caption.placement="top")


Fleet6_AIC.table = xtable(Fleet6_AIC,
                            caption = c("Model selection for the CRFS CPFV onboard observer 
                                        index of abundance for north of Pt. Conception. Bold 
                                        values indicate the model selected."),
                            label='tab:Fleet6_AIC')

print(Fleet6_AIC.table, 
              include.rownames=FALSE, 
              caption.placement="top",
              sanitize.text.function = function(x){x})


Fleet7_AIC.table = xtable(Fleet7_AIC,
                            caption = c("Model selection for the CRFS CPFV onboard observer 
                                        index of abundance for south of Pt. Conception. Bold 
                                        values indicate the model selected."),
                            label='tab:Fleet7_AIC')

print(Fleet7_AIC.table, 
              include.rownames=FALSE, 
              caption.placement="top",
              sanitize.text.function = function(x){x})
     
```